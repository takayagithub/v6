<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Affinia - 診断結果</title>

    <!-- OGタグ -->
    <meta property="og:title" content="Affinia - 診断結果">
    <meta property="og:description" content="今日のあなたに近い Affinia タイプをチェック！">
    <meta property="og:type" content="website">
    <meta property="og:image" content="/img/og-image.png">
    <meta property="og:url" content="https://affinia.pages.dev/result">

    <!-- 共有 -->
    <script src="type-images.js"></script>
    <script src="types.json"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>

<header class="header">
    <div class="logo">Affinia</div>
    <button class="menu-toggle" onclick="toggleMenu()">☰</button>
</header>

<!-- ハンバーガーメニュー -->
<nav id="sideMenu" class="side-menu">
    <button class="close-btn" onclick="toggleMenu()">×</button>
    <ul>
        <li><a href="index.html">診断</a></li>
        <li><a href="types.html">タイプ一覧</a></li>
        <li><a href="compatibility.html">タイプ相性</a></li>
        <li><a href="about.html">Affiniaとは</a></li>
    </ul>
</nav>

<main class="result-container">

    <!-- タイトル -->
    <section class="result-title">
        <h2>あなたの Affinia タイプは…</h2>
    </section>

    <!-- キャラ画像 -->
    <section class="result-visual">
        <img id="type-image" src="" alt="タイプ画像">
    </section>

    <!-- タイプ名＋コード -->
    <section class="result-main">
        <h1 id="type-name"></h1>
        <p id="type-code" class="type-code"></p>
        <p id="type-catch" class="catchcopy"></p>
        <p id="type-desc" class="typedesc"></p>
    </section>

    <!-- 相性サマリ -->
    <section class="compat-summary">
        <h3>このタイプの傾向</h3>
        <ul id="compat-summary-list"></ul>
    </section>

    <!-- 広告枠 -->
    <section class="ad-section">
        <div class="ad-box">広告エリア（300×250）</div>
    </section>

    <!-- シェア -->
    <section class="share-section">
        <h3>シェアする</h3>
        <div class="share-icons">
            <a id="share-x" class="icon x">X</a>
            <a id="share-line" class="icon line">LINE</a>
            <a id="share-instagram" class="icon ig">Instagram</a>
            <a id="share-qr" class="icon qr">QR</a>
        </div>
        <p class="share-count">4.9M+</p>
    </section>

</main>

<footer class="footer">
    <div>
        <a href="about.html">Affiniaとは</a>　
        <a href="types.html">タイプ一覧</a>　
        <a href="compatibility.html">タイプ相性</a>　
        <a href="terms.html">利用規約</a>　
        <a href="privacy.html">プライバシー</a>
    </div>
    <p>© 2025 Affinia</p>
</footer>

<script>
/* メニュー開閉 */
function toggleMenu() {
    const menu = document.getElementById("sideMenu");
    menu.classList.toggle("open");
}

/* URL からコード取得 */
function getParam(name) {
    const url = new URL(window.location.href);
    return url.searchParams.get(name);
}

/* 結果描画 */
async function renderResult() {
    const code = getParam("code");
    if (!code) return;

    const res = await fetch("types.json");
    const types = await res.json();
    const t = types.find(v => v.code === code);

    if (!t) return;

    // 画像
    const imgPath = getTypeImagePath(t.name);
    if (imgPath) {
        document.getElementById("type-image").src = imgPath;
    }

    // テキスト
    document.getElementById("type-name").textContent = t.name;
    document.getElementById("type-code").textContent = "Affiniaコード: " + t.code;
    document.getElementById("type-catch").textContent = t.catch;
    document.getElementById("type-desc").textContent = t.desc;

    // 相性サマリ
    const list = document.getElementById("compat-summary-list");
    t.summary.forEach(s => {
        const li = document.createElement("li");
        li.textContent = s;
        list.appendChild(li);
    });

    // シェア
    const shareUrl = location.href;
    document.getElementById("share-x").href =
        "https://twitter.com/share?url=" + encodeURIComponent(shareUrl);
    document.getElementById("share-line").href =
        "https://social-plugins.line.me/lineit/share?url=" + encodeURIComponent(shareUrl);
}

renderResult();
</script>

</body>
</html>
